#!/bin/bash

# check to see if we're going to push another branch
if [[ $# -eq 0 ]] ; then
    branch="master"
else
    branch=$1
fi

# Add the origin if it doesn't exist
if [[ $(git remote | grep origin) == '' ]];
then
    echo "Adding origin as remote"
    git remote add origin wh260@appcs.ra.phy.cam.ac.uk:~/thesis.git 
fi

# Add appcs if it doesn't exist
if [[ $(git remote | grep appcs) == '' ]];
then
    echo "Adding appcs as remote"
    git remote add appcs wh260@appcs.ra.phy.cam.ac.uk:~/thesis.git 
fi

# Add srcf if it doesn't exist
if [[ $(git remote | grep srcf) == '' ]];
then
    echo "Adding srcf as remote"
    git remote add srcf wh260@shell.srcf.net:~/thesis.git 
fi

# Add the local one if it doesn't exist
if [[ $(git remote | grep local) == '' ]]
then
    backup_dir="~/.thesis_backup.git"
    # If a local directory doesn't exists, then create it
    if [[ ! -d $backup_dir ]]
    then
        echo " ... Creating backup directory"
        mkdir $backup_dir
        cd $backup_dir
        git init --bare --shared=0777
        cd -
    fi

    echo "Adding local as remote"
    git remote add local $backup_dir
fi

# Add the home backup 
if [[ $(git remote | grep local) == '' ]]
then
    echo "Adding house as remote"
    git remote add house will@8parkterrace.homelinux.com:/media/will/Bernoulli/thesis_backup.git
fi



# Now back them up
for i in origin local house appcs srcf;
do
    echo "======================== Pushing to $i =============================="
    git push $i $branch
done
